<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Sheet CRUD Demo</title>
</head>
<body>
  <h2>Google Sheets CRUD Example</h2>

  <input id="name" placeholder="Name">
  <input id="email" placeholder="Email">
  <input id="message" placeholder="Message">
  <button onclick="addData()">Add</button>

  <h3>Data:</h3>
  <div id="output"></div>

  <script>
    const api = "https://script.google.com/macros/s/AKfycbzZ8NuuRbkTlqrG_vZawbQ08jQahBp-Y-1VJjkvDIcnlxrVVLw8UoqhelcfXkR6qJdPgA/exec";

    function fetchData() {
      fetch(api)
        .then(res => res.json())
        .then(data => {
          const html = data.map(row => `
            <div>
              <b>${row.Name}</b> (${row.Email}) â€” ${row.Message}
              <button onclick="editData(${row.ID})">âœï¸</button>
              <button onclick="deleteData(${row.ID})">ğŸ—‘ï¸</button>
            </div>
          `).join('');
          document.getElementById("output").innerHTML = html;
        });
    }

    function addData() {
      const body = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        message: document.getElementById("message").value
      };

      fetch(api, {
        method: "POST",
        body: JSON.stringify(body)
      }).then(res => res.text()).then(() => fetchData());
    }

    function editData(id) {
      const name = prompt("New name:");
      const email = prompt("New email:");
      const message = prompt("New message:");

      const body = { id, name, email, message };

      fetch(api, {
        method: "PUT",
        body: JSON.stringify(body)
      }).then(res => res.text()).then(() => fetchData());
    }

    function deleteData(id) {
      fetch(`${api}?id=${id}`, { method: "DELETE" })
        .then(res => res.text())
        .then(() => fetchData());
    }

    fetchData(); // load data on start
  </script>
</body>
</html>
