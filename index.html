<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Google Sheet CRUD (No CORS)</title>
<style>
  body { font-family: sans-serif; margin: 40px; }
  input, button { margin: 5px; padding: 5px; }
  pre { background: #f4f4f4; padding: 10px; border-radius: 8px; }
</style>
</head>
<body>
  <h2>Google Sheet CRUD (No CORS)</h2>

  <div>
    <input id="name" placeholder="Name">
    <input id="email" placeholder="Email">
    <button onclick="create()">Add Row</button>
  </div>

  <div>
    <input id="rowIndex" type="number" placeholder="Row # (starting 1)">
    <button onclick="update()">Edit</button>
    <button onclick="remove()">Delete</button>
  </div>

  <button onclick="read()">View All</button>

  <pre id="output"></pre>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxiclibwaB4eW1iGwLA_0TKwijs4AVAl-iuFvzqqxG3pWgK7977CdI0sLVUzvF1wfV6Hw/exec";

async function sendData(payload) {
  const res = await fetch(API_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });
  const text = await res.text();
  try { return JSON.parse(text); } catch { return text; }
}

async function create() {
  const name = document.getElementById("name").value;
  const email = document.getElementById("email").value;
  const data = await sendData({ _method: "POST", name, email });
  document.getElementById("output").textContent = JSON.stringify(data, null, 2);
}

async function read() {
  const data = await sendData({ _method: "GET" });
  document.getElementById("output").textContent = JSON.stringify(data, null, 2);
}

async function update() {
  const rowIndex = parseInt(document.getElementById("rowIndex").value);
  const name = document.getElementById("name").value;
  const email = document.getElementById("email").value;
  const data = await sendData({ _method: "PUT", rowIndex, name, email });
  document.getElementById("output").textContent = JSON.stringify(data, null, 2);
}

async function remove() {
  const rowIndex = parseInt(document.getElementById("rowIndex").value);
  const data = await sendData({ _method: "DELETE", rowIndex });
  document.getElementById("output").textContent = JSON.stringify(data, null, 2);
}
</script>
</body>
</html>
